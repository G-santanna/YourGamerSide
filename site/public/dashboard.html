<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Your Gamer Side - Dashboard</title>
    <link rel="stylesheet" href="css/side-header.css">
    <link rel="stylesheet" href="css/dashboard.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,400;0,600;1,800&display=swap" rel="stylesheet">
    <link rel="shortcut icon" href="./assets/imgs/logoYGS.svg" type="image/x-icon">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

</head>
<body onload="getSurveysData()">
    <header>
        <a href="index.html"><img src="assets/imgs/logoYGS.svg"></a>
        <div class="links">
            <a href="statistics.html"><span>Estatísticas</span></a>
            <a href="survey.html"><span>Pesquisa</span></a>
            <a href="index.html"><span>Jogar</span></a>
        </div>
        <div class="icons">
            <!-- <a href=""><img src="assets/imgs/bell.png"></a> -->
            <a href=""><img src="assets/imgs/user.png"></a>
            <a href="landingpage.html" onclick="limparSessao()"><img src="assets/imgs/sign-out.png"></a>
            <!-- <a href=""><img src="assets/imgs/settings.png"></a> -->
        </div>
    </header>
    <section>
        <div class="kpiAge">
            <div>
                <span>Idade média do 1º contato dos <span class="inclusivo">inclusivos</span> com o jogo</span>
                <h1 id="mediaIdadeI"></h1>
                <h2 id="menorIdadeI"></h2>
                <h2 id="maiorIdadeI"></h2>
            </div>
            <div>
                <span>Idade média do 1º contato dos homens com o jogo</span>
                <h1 id="mediaIdadeM"></h1>
                <h2 id="menorIdadeM"></h2>
                <h2 id="maiorIdadeM"></h2>
            </div>
        </div>
        <div>
            <div class="questions">
                <canvas id="questions"></canvas>
            </div>
        </div>
        <div>
            <div class="exp">
                <canvas id="expectation"></canvas>
            </div>
            <div class="real">
                <canvas id="reality"></canvas>
            </div>
        </div>
        <div>
            <div class="gender">
                <canvas id="gender"></canvas>
            </div>
        </div>
    </section>
</body>
</html>
<script>

function getSurveysData(){
    fetch(`/surveys/listar`)
        .then(resposta => {
            console.log(resposta);
            if (resposta.ok) {
                resposta.json().then(resposta => {
                    console.log(resposta)
                    console.log(`Dados recebidos: ${JSON.stringify(resposta)}`);
                    mediaIdadeI.innerHTML = `${resposta[0].avgAge}y`
                    menorIdadeI.innerHTML = `${resposta[0].minAge}y`
                    maiorIdadeI.innerHTML = `${resposta[0].maxAge}y`
                    mediaIdadeM.innerHTML = `${resposta[1].avgAge}y`
                    menorIdadeM.innerHTML = `${resposta[1].minAge}y`
                    maiorIdadeM.innerHTML = `${resposta[1].maxAge}y`
                });
            } else {
                console.error(`Nenhum dado encontrado ou erro na API`);
            }
        })
        .catch(function (error) {
            console.error(`Erro na obtenção dos dados`+error);
        });
}

const labelsBar = ['oi', 'oi2', 'oi3', 'oi4'];
const dataBar = {
  labels: labelsBar,
  datasets: [{
    label: 'My First Dataset',
    data: [65, 59, 80, 81, 56, 55, 40],
    backgroundColor: [
      'rgba(255, 99, 132, 0.2)',
      'rgba(255, 159, 64, 0.2)',
      'rgba(255, 205, 86, 0.2)',
      'rgba(201, 203, 207, 0.2)'
    ],
    borderColor: [
      'rgb(255, 99, 132)',
      'rgb(255, 159, 64)',
      'rgb(255, 205, 86)',
      'rgb(201, 203, 207)'
    ],
    borderWidth: 1
  }]
};
const configBar = {
  type: 'bar',
  data: dataBar,
  options: {
    scales: {
      y: {
        beginAtZero: true
      }
    }
  },
};


const dataPieExp = {
  labels: [
    'Amigável',
    'Pacífico',
    'Hostil',
    'Sem expectativa'
  ],
  datasets: [{
    data: [150, 80, 100, 80],
    backgroundColor: [
      '#f7768e',
      '#c98eae',
      '#9aa5ce',
      '#CFC9C2'
    ],
    hoverOffset: 4
  }]
};

const configPieExp = {
  type: 'pie',
  data: dataPieExp,
};

const dataPieReal = {
  labels: [
    'Amigável',
    'Pacífico',
    'Hostil'
  ],
  datasets: [{
    data: [300, 50, 100],
    backgroundColor: [
      '#f7768e',
      '#c98eae',
      '#9aa5ce'
    ],
    hoverOffset: 4
  }]
};

const configPieReal = {
  type: 'pie',
  data: dataPieReal,
};

const dataGender = {
  labels: [
    'Masculino',
    'Feminino',
    'Não-Binário',
    'Outros'
  ],
  datasets: [{
    label: 'My First Dataset',
    data: [80, 70, 100, 80],
    backgroundColor: [
      '#f7768e',
      '#c98eae',
      '#9aa5ce',
      '#CFC9C2'
    ],
    hoverOffset: 4
  }]
};

const configGender = {
  type: 'doughnut',
  data: dataGender,
};

new Chart(questions, configBar);
new Chart(expectation, configPieExp);
new Chart(reality, configPieReal);
new Chart(gender, configGender);



</script>